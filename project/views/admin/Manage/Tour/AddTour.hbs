<div class="content-wrapper">
    <div class="container-fluid">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="/admin/managetour">Quản lý Tour</a>
            </li>
            <li class="breadcrumb-item active">Thêm Tour mới</li>
        </ol>

        <div class="container mt-4" style="max-width: 800px;">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Tạo Tour Mới</h3>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">

                    <form action="/admin/addtour" method="POST" enctype="multipart/form-data">

                        <div class="mb-4">
                            <label for="ten_tour" class="form-label fw-bold">Tên Tour</label>
                            <input type="text" class="form-control" id="ten_tour" name="ten_tour"
                                   placeholder="Ví dụ: Tour du lịch Đà Lạt 3 ngày 2 đêm..." required>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="diem_di" class="form-label fw-bold">
                                    Điểm Đi (Khởi hành)
                                </label>
                                <select name="diem_di" id="diem_di" class="form-control" required>
                                    <option value="">-- Chọn nơi khởi hành --</option>
                                    {{#each locations}}
                                        <option value="{{this.ma_dia_diem}}">{{this.ten_dia_diem}}</option>
                                    {{/each}}
                                </select>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="diem_den" class="form-label fw-bold">
                                    Điểm Đến (Kết thúc)
                                </label>
                                <select name="diem_den" id="diem_den" class="form-control" required>
                                    <option value="">-- Chọn nơi đến --</option>
                                    {{#each locations}}
                                        <option value="{{this.ma_dia_diem}}">{{this.ten_dia_diem}}</option>
                                    {{/each}}
                                </select>
                            </div>
                        </div>


                        <div class="mt-4 d-flex justify-content-between">
                            <div>
                                <button type="reset" class="btn btn-warning" style="cursor: pointer">
                                   Nhập lại
                                </button>
                                <a href="/admin/managetour" class="btn btn-secondary ms-2">Hủy bỏ</a>
                            </div>

                            <button type="submit" class="btn btn-primary px-5 font-weight-bold" style="cursor: pointer">
                                Lưu Tour
                            </button>
                        </div>

                    </form>

                </div>
            </div>
        </div>

    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const startSelect = document.getElementById("diem_di");
        const endSelect = document.getElementById("diem_den");

        // Xử lý ẩn hiện option
        function filterOptions(sourceSelect, targetSelect) {
            const selectedValue = sourceSelect.value;
            const options = targetSelect.options;

            for (let i = 0; i < options.length; i++) {
                // Nếu value trùng với bên kia -> Disable
                if (options[i].value === selectedValue && selectedValue !== "") {
                    options[i].disabled = true;
                    // Nếu lỡ đang chọn cái bị disable thì reset về rỗng
                    if (targetSelect.value === selectedValue) {
                        targetSelect.value = "";
                    }
                } else {
                    // Ngược lại thì mở cho chọn
                    options[i].disabled = false;
                }
            }
        }

        // Bắt sự kiện khi người dùng thay đổi lựa chọn
        startSelect.addEventListener("change", function() {
            filterOptions(startSelect, endSelect);
        });

        endSelect.addEventListener("change", function() {
            filterOptions(endSelect, startSelect);
        });
    });
</script>